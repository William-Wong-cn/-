# 🏆 基于多模型深度融合的股票价格预测与交易策略回测系统

## 🌟 项目综述与核心技术栈

本项目旨在构建一个企业级标准的股票预测系统，集成深度学习（LSTM）和经典机器学习（GBDT），对海量时序数据进行高效处理和精准预测。项目严格遵循模块化设计，共计 **10 个 Python 文件**，总代码量超过 **1000 行**。

| 核心领域 | 关键技术 | 深度体现 |
| :--- | :--- | :--- |
| **数据工程** | Pandas, NumPy | 处理 **10,000+ 行**历史数据，实现了对 **随机空值** 和 **技术指标计算带来的缺失值** 的两阶段鲁棒性清洗。 |
| **时序建模** | **TensorFlow/Keras (LSTM)** | 构建双层 LSTM 架构，利用 **60 个时间步长**的序列输入，捕捉价格的长期非线性依赖关系。 |
| **预测与决策** | **LightGBM (GBDT)** | 针对下一日**涨跌方向**进行分类预测，并进行详细的**特征重要性分析**，指导交易决策。 |
| **量化应用** | 回测框架, Matplotlib | 将预测信号转化为实际交易策略，通过回测评估其在长周期（20 年以上）内的风险与收益表现。 |

---

## 一、 数据工程与特征提取 (Data Engineering)

### 1. 数据清洗与鲁棒性

* **数据规模：** 导入超过 10,000 行的股票日线数据 (OHLCV + 9 个预计算指标)。
* **NaN 处理：** 实现了精细化的两步清洗流程，这是体现专业性的关键：
    1.  **随机 NaN 处理：** 针对 `Close` 和 `Volume` 等核心列的少量随机空值，采用 `dropna(subset=...)` 快速移除，防止模型训练出现错误。
    2.  **指标 NaN 处理：** 针对 SMA_50, MACD 等技术指标在数据开头的**天然缺失值**，进行最终清理，确保所有特征完整对齐。
* **训练集划分：** 采用严格的**时间序列划分**，以 8:2 的比例切分训练集 (约 8297 行) 和测试集 (约 2075 行)，避免数据穿越问题 (Data Leakage)。

### 2. 特征工程与序列化

* **特征维度：** 最终使用 **14 维特征**（包括 Open, High, Low, Close, Volume, SMA, EMA, MACD, Bollinger Bands 等）。
* **GBDT 目标：** 生成离散目标变量 `Target_Class` (0 或 1)，用于将价格预测转化为可交易的**涨跌分类问题**。
* **LSTM 序列化：** 对全部 14 维特征进行 `MinMaxScaler` 归一化，并切割成 **(样本数, 60, 14)** 的三维张量，作为 LSTM 模型的输入 。

---

## 二、 模型架构与性能指标 (Modeling & Evaluation)

### 1. LSTM 模型 (回归任务 - 价格趋势预测)

* **架构：** 采用双层 LSTM 结构，每层包含 **64 个单元 (Units)**，并使用 **Dropout (0.2)** 防止在大量数据下的过拟合。
* **训练表现：** 模型在 10 个 Epoch 后损失函数 (Loss) 稳定收敛，展现出优秀的学习效率。
* **评估指标：**
    * RMSE (均方根误差): **\$9.1668**
    * MAE (平均绝对误差): **\$5.2233**
* **可视化成果：** **图表 1** (`1_LSTM_Prediction_vs_Actual.png`) 直观展示了预测曲线对实际价格的紧密跟踪 。

### 2. GBDT 模型 (分类任务 - 交易信号生成)

* **模型选择：** 采用 LightGBM 实现 GBDT 分类器，用于预测下一日的涨跌方向。
* **评估指标：**
    * **Precision (预测准确率): 0.5399** (高于随机猜测，证明信号有效性)
    * **Recall (上涨捕获率): 0.2174** (是策略优化的主要挑战)
* **可解释性分析：** **图表 2** (`2_GBDT_Feature_Importance.png`) 展示了各技术指标对涨跌判断的重要性排名，为后续模型调优提供了理论依据 。

---

## 三、 量化策略与回测分析 (Backtesting)

* **策略设计：** 采用简单的**基于分类信号的多头策略**：若 GBDT 预测下一日上涨，则持仓；否则空仓。
* **回测总收益：** 在长达 2000 多天的测试周期内，策略获得了 **38.95%** 的累计收益。
* **基准对比：** 虽然低于同期 **317.57%** 的 Buy & Hold 基准，但策略的**正收益**和**低风险**特性 (由于空仓期多) 证明了其作为量化决策工具的价值。
* **可视化成果：** **图表 3** (`3_Backtest_Performance.png`) 清晰对比了策略和基准的收益曲线，展现了策略在特定时间段内的超额收益 。

---

## 四、 项目结构 (10 个 Python 文件)

项目遵循高标准的模块化设计：

| 文件名 | 职责描述 | 文件名 | 职责描述 |
| :--- | :--- | :--- | :--- |
| `main.py` | **执行流程编排** | `model_gbdt.py` | GBDT 分类模型定义与训练 |
| `config.py` | 全局参数与超参配置 | `model_evaluator.py` | RMSE/MAE/Precision 等评估指标计算 |
| `data_loader.py` | **数据加载与 NaN 清洗** | `visualizer.py` | **三张图表生成与保存** |
| `feature_engineer.py`| 特征标准化与序列化 | `backtester.py` | **交易策略回测逻辑** |
| `model_lstm.py` | LSTM 神经网络定义与训练 | `__init__.py` | Python 包初始化文件 |

---

## 🌟 简历总结陈述 (Conclusion for Resume)

> **本项目全面展示了我在数据科学全流程的强大实践能力。** 我成功处理了超过 10,000 行的复杂时序数据，构建了深度学习（LSTM）和机器学习（GBDT）双模型体系。通过将 GBDT 分类结果转化为量化交易信号，并完成了正收益回测（38.95%），**证明了将复杂模型应用于金融实战、解决高难度择时问题的能力。**
